<!DOCTYPE html>
<html>
<head>
  <style>
    body { font-family: Arial, sans-serif; color: #333; }
    .container { max-width: 600px; margin: 20px auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
    .header { background-color: #0056b3; color: white; padding: 10px; text-align: center; border-radius: 8px 8px 0 0; }
    .content { padding: 20px; }
    .summary-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    .summary-table td { padding: 8px; border-bottom: 1px solid #eee; }
    .summary-table td:first-child { font-weight: bold; }
    .footer { text-align: center; font-size: 0.9em; color: #777; margin-top: 20px; }
    /* Estilo para la lista de adicionales dentro de la tabla */
    .adicionales-list { list-style: none; padding-left: 0; margin: 0; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h2>¡Tu Reserva está Confirmada!</h2>
    </div>
    <div class="content">
      <p>Hola <strong><?= nombreCompleto ?></strong>,</p>
      <p>Nos complace confirmar tu solicitud de reserva para el salón "El Templo de Claypole". A continuación, te dejamos un resumen de tu evento:</p>
      
      <table class="summary-table">
        <tr>
          <td>Tipo de Evento:</td>
          <td><?= tipoEvento ?></td>
        </tr>
        <tr>
          <td>Fecha:</td>
          <td><?= fechaEvento ?></td>
        </tr>
        <tr>
          <td>Hora de Inicio:</td>
          <td><?= horaInicio ?> hs.</td>
        </tr>
        <tr>
          <td>Duración:</td>
          <td><?= duracionEvento ?></td>
        </tr>
        <tr>
          <td>Hora de Finalización:</td>
          <td>
            <?
              var horaFinStr = 'No especificada';
              var duracion = duracionEvento;
              var hora = horaInicio;
              var duracionMatch = duracion ? duracion.match(/\d+/) : null;
              var duracionNum = duracionMatch ? parseInt(duracionMatch[0]) : 0;
              if (hora && duracionNum > 0) {
                  var horaParts = hora.split(':');
                  var startHour = parseInt(horaParts[0]);
                  var startMinute = parseInt(horaParts[1] || '0');
                  if (!isNaN(startHour) && !isNaN(startMinute)) {
                      var fechaCalculo = new Date();
                      fechaCalculo.setHours(startHour, startMinute, 0, 0);
                      fechaCalculo.setHours(fechaCalculo.getHours() + duracionNum);
                      var endHour = fechaCalculo.getHours();
                      var endMinute = String(fechaCalculo.getMinutes()).padStart(2, '0');
                      horaFinStr = endHour + ':' + endMinute + ' hs.';
                  }
              }
            ?>
            <?= horaFinStr ?>
          </td>
        </tr>
        <tr>
          <td>Cantidad de Personas:</td>
          <td><?= cantidadPersonas ?></td>
        </tr>
        
        <!-- --- NUEVA SECCIÓN PARA ADICIONALES --- -->
        <? if (adicionales && adicionales.length > 0) { ?>
          <tr>
            <td valign="top">Adicionales:</td>
            <td>
              <ul class="adicionales-list">
                <? adicionales.forEach(function(ad) { ?>
                  <li>- <?= ad.nombre ?> ($<?= ad.precio.toLocaleString('es-AR') ?>)</li>
                <? }); ?>
              </ul>
            </td>
          </tr>
        <? } ?>
        <!-- --- FIN DE NUEVA SECCIÓN --- -->

        <tr>
          <td><strong>Precio Final:</strong></td>
          <td><strong>$<?= precioFinal.toLocaleString('es-AR') ?></strong></td>
        </tr>
      </table>

      <p>Nos pondremos en contacto contigo a la brevedad para coordinar los siguientes pasos, incluyendo los detalles del pago.</p>
      <p>¡Gracias por elegirnos!</p>
    </div>
    <div class="footer">
      <p>El Templo de Claypole</p>
    </div>
  </div>
</body>
</html>